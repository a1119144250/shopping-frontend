<!--pages/search/search.wxml-->
<view class="container">
  <!-- 搜索栏 -->
  <view class="search-header">
    <view class="search-input-wrapper">
      <input class="search-input" 
             placeholder="搜索商品" 
             value="{{keyword}}" 
             bindinput="onKeywordInput"
             bindconfirm="onSearch"
             focus="{{true}}"
             confirm-type="search" />
      <view class="search-btn" bindtap="onSearch">搜索</view>
    </view>
  </view>

  <!-- 搜索历史 -->
  <view class="search-history" wx:if="{{!keyword && searchHistory.length > 0}}">
    <view class="history-header">
      <text class="history-title">搜索历史</text>
      <text class="history-clear" bindtap="onClearHistory">清空</text>
    </view>
    <view class="history-tags">
      <block wx:for="{{searchHistory}}" wx:key="index">
        <view class="history-tag" bindtap="onHistoryTap" data-keyword="{{item}}">
          {{item}}
        </view>
      </block>
    </view>
  </view>

  <!-- 热门搜索 -->
  <view class="hot-search" wx:if="{{!keyword && hotKeywords.length > 0}}">
    <view class="hot-header">
      <text class="hot-title">热门搜索</text>
    </view>
    <view class="hot-tags">
      <block wx:for="{{hotKeywords}}" wx:key="index">
        <view class="hot-tag" bindtap="onHotKeywordTap" data-keyword="{{item}}">
          {{item}}
        </view>
      </block>
    </view>
  </view>

  <!-- 搜索结果 -->
  <view class="search-results" wx:if="{{keyword && searchResults.length > 0}}">
    <view class="results-header">
      <text class="results-count">找到 {{searchResults.length}} 个相关商品</text>
    </view>
    <view class="results-list">
      <block wx:for="{{searchResults}}" wx:key="id">
        <view class="result-item" bindtap="onProductClick" data-product="{{item}}">
          <image class="result-image" src="{{item.image}}" mode="aspectFill"></image>
          <view class="result-info">
            <text class="result-name">{{item.name}}</text>
            <text class="result-desc">{{item.description}}</text>
            <view class="result-meta">
              <text class="result-sales">月销 {{item.sales}}</text>
              <view class="result-rating">
                <text class="rating-text">{{item.rating}}</text>
                <text class="rating-star">★</text>
              </view>
            </view>
            <view class="result-bottom">
              <view class="result-price">
                <text class="price-current">¥{{item.price}}</text>
                <text class="price-original" wx:if="{{item.originalPrice}}">¥{{item.originalPrice}}</text>
              </view>
              <view class="add-cart-btn" bindtap="onAddToCart" data-product="{{item}}">
                <text>+</text>
              </view>
            </view>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-results" wx:if="{{keyword && searchResults.length === 0 && !loading}}">
    <image class="empty-icon" src="/images/empty-search.png" mode="aspectFit"></image>
    <text class="empty-text">没有找到相关商品</text>
    <text class="empty-desc">试试其他关键词吧</text>
  </view>

  <!-- 加载状态 -->
  <view class="loading" wx:if="{{loading}}">
    <text>搜索中...</text>
  </view>
</view>
